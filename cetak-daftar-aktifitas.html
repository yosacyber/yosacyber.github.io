<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>
<body>
    <h1>Mencetak Daftar Aktifitas pada Aplikasi E-RK</h1>
 <code>
(function() { &quot;use strict&quot;; console.clear(); function getAktifitas(selector) { var results = []; var pattern = /\s+Waktu\s+:\s+([\d]*)\s+Menit/img; document.querySelectorAll(selector).forEach(function(item, index) { var text = item.querySelector(&quot;p&quot;).textContent; var durasi = /Waktu\s+:\s+([^\s]*)/img.exec(text), nomor = index + 1; if( /\s+waktu\s+:/img.test(text) ) { text = text.replace(/\s+Waktu.*Menit/img, ''); text = text.replace(/^\d+.\s+/img, ''); results.push({durasi: parseInt( durasi[1].trim() ), aktifitas: text.trim()}); } }); // Mengurutkan aktifitas berdasarkan durasi results.sort(function(a, b) { return a.durasi - b.durasi; }); results.reverse(); var html = ''; results.forEach(function(item, index) { var nomor = index + 1; html = `${html} &lt;tr&gt; &lt;td class=&quot;text-center&quot; style=&quot;width: 80px;&quot; nowrap&gt;${nomor}&lt;/td&gt; &lt;td class=&quot;text-center&quot; style=&quot;width: 80px;&quot; nowra&gt;${item.durasi}&lt;/td&gt; &lt;td&gt;${item.aktifitas}&lt;/td&gt; &lt;/tr&gt; `; }); return html; } var title =&quot;Cetak Daftar Aktifitas&quot;; var aktivitasUtama = getAktifitas('div#pilih-aktivitas-scroller &gt; div'); var aktivitasTambahan = getAktifitas('div#pilih-aktivitas-tambahan-scroller &gt; div'); console.log(aktivitasUtama); var namaPegawai = document.querySelector(&quot;a.profile-header &gt; div &gt; b&quot;).textContent, namaJabatan = document.querySelector(&quot;a.profile-header &gt; div &gt; span&quot;).textContent, nipPegawai; var newtab = window.open(); newtab.document.open(); newtab.document.write(` &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt; &lt;title&gt;${title}&lt;/title&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.8/spectre.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.8/spectre-exp.min.css&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;https://cdnjs.cloudflare.com/ajax/libs/spectre.css/0.5.8/spectre-icons.min.css&quot; /&gt; &lt;style&gt; @media print { .pagebreak { page-break-before: always; } /* page-break-after works, as well */ } &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div class=&quot;container&quot;&gt; &lt;h3 class=&quot;text-center text-uppercase&quot;&gt;Daftar Aktifitas&lt;/h3&gt; &lt;div class=&quot;divider&quot;&gt;&lt;/div&gt; &lt;/div&gt; &lt;div class=&quot;container&quot;&gt; &lt;table border=&quot;0&quot; cellpadding=&quot;0&quot; cellspacing=&quot;0&quot; style=&quot;width: 100%;&quot;&gt; &lt;tr&gt; &lt;td style=&quot;width: 120px;&quot; nowrap&gt;Nama Pegawai&lt;/td&gt; &lt;td style=&quot;width: 25px; text-align: center;&quot;&gt;:&lt;/td&gt; &lt;td class=&quot;text-bold&quot;&gt;${namaPegawai}&lt;/td&gt; &lt;/tr&gt; &lt;tr&gt; &lt;td nowrap&gt;Jabatan Fungsional&lt;/td&gt; &lt;td style=&quot;text-align: center;&quot;&gt;:&lt;/td&gt; &lt;td class=&quot;text-uppercase text-bold&quot;&gt;${namaJabatan}&lt;/td&gt; &lt;/tr&gt; &lt;/table&gt; &lt;h5&gt;&amp;nbsp;&lt;/h5&gt; &lt;/div&gt; &lt;div class=&quot;container&quot;&gt; &lt;table class=&quot;table table-striped&quot;&gt; &lt;thead&gt; &lt;tr class=&quot;text-center&quot;&gt; &lt;th nowrap&gt;NO&lt;/th&gt; &lt;th nowrap&gt;DURASI&lt;/th&gt; &lt;th nowrap&gt;AKTIFITAS UTAMA&lt;/th&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; ${aktivitasUtama} &lt;/tbody&gt; &lt;/table&gt; &lt;/div&gt; &lt;div class=&quot;pagebreak&quot;&gt; &lt;/div&gt; &lt;div class=&quot;container&quot;&gt; &lt;table class=&quot;table table-striped&quot;&gt; &lt;thead&gt; &lt;tr class=&quot;text-center&quot;&gt; &lt;th nowrap&gt;NO&lt;/th&gt; &lt;th nowrap&gt;DURASI&lt;/th&gt; &lt;th nowrap&gt;AKTIFITAS TAMBAHAN&lt;/th&gt; &lt;/tr&gt; &lt;/thead&gt; &lt;tbody&gt; ${aktivitasTambahan} &lt;/tbody&gt; &lt;/table&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; `); newtab.document.close(); newtab.focus(); setTimeout(function () { newtab.print(); newtab.close(); }, 100); })();
    </code>
    
</body>
</html>
